# コンピュータ構成要素

## プロセッサ

### プロセッサの構造と動作原理

- 基本構成

	- 演算装置

		- 算術論理演算装置
		- フラグレジスタ

	- 制御装置

		- デコーダ、プログラムカウント

	- レジスタ

		- 汎用レジスタ

			- 中間結果保持
			- ベースアドレス
			- インデックスレジスタ
			- など

		- 専用レジスタ

			- メモリアドレスレジスタ
			- 命令レジスタ
			- データレジスタ

- 割込み

	- 外部割込み

		- 機械チェック割込み

			- 処理装置の誤動作
			- 電源・電圧異常
			- 主記憶障害
			- NMI（NonーMaskable Interrupt）

				- ソフトウェアでこのNMIを禁止することはできない

		- 入出力割込み

			- 入出力完了
			- 入出力状態変化（印刷装置の紙切れ、電源OFFなど）

		- 外部信号／コンソール割込み

			- システム操作卓からの指示
			- 外部信号（測定器など）

		- タイマ割込み

			- 所定時間経過（インタバルタイマ）
			- 所定時刻経過

	- 内部割込み

		- プログラム割込み（例外割込み）

			- オーバフロー
			- アンダフロー
			- 不正命令コード実行
			- 0による除算
			- アドレス指定エラー
			- 記憶保護違反

		- SVC （スーパバイザコール）：制御プログラム呼出し割込み

			- 入出力操作要求
			- タスク切替え
			- ページフォールト

		- ページフォールト

			- 仮想記憶管理において存在しないページにアクセスするときに行われる

	- 特性

		- 優先順位が付けられ、多重割込み制御が可能
		- 割込みの状態はPSW（Program Status Word：プログラム状態語に格納される）

	- 割込み動作

		- ①現在実行中のプログラムのPSW（旧PSW）をスタックに待避
		- ②割込み処理に対応したルーチンのPSW（新PSW）を設定
		- ③割込み処理ルーチンの実行

			- routine

				- ある機能を持ったの一連の命令群

		- ④旧PSWを新PSWにする
		- ⑤中断したプログラムの再開

- エンディアン（endian）

	- リトルエンディアン

		- Intel系ほぼ、x86なら32bit単位、i64なら64bit単位

	- ビッグエンディアン

### 命令セット

- アーキテクチャ

	- CISC（Complex Instruction Set Computer）

		- 複雑命令をVLSIでワンチップ化すること

			- VLSI：Very Large Scale Integration、大规模集成电路

		- 命令群：マイクロプログラム（ストアドロジック）

			- MicroProgram（Stored Logic）

	- RISC（Reduced Instruction Set Computer）

		- 使用頻度の高い基本的な簡易命令だけにとどめ、各命令の実行じかんを向上させようとする方式である
		- 1命令の長さを固定長とし、さらに、1命令の実行時間を一定似することを重視している
		- 結線論理（ワイヤードロジック、布線論理、配線論理）

			- 命令の基本動作に対した固定配線を用意し、命令の解読結果に従って部分動作をする回路を順次呼出して１つの命令を実行する方式である

		- 一般的にプログラムの容量がCISCより大きくなることが多い、コンパイラの最適化技術が重要である

	- ベクトル（Vector）プロセッサ

		- ベクトル計算機 (ベクトルけいさんき) は、ベクトル演算（SIMDを参照）を行えるコンピュータのこと。特に（狭義では）ベクトル演算のための高性能でパイプライン化された実行ユニットを持ち、その演算能力を可能な限り発揮できるように全てが設計されたアーキテクチャを持つスーパーコンピュータを指す。

	- VILW：Very Long Instruction Word：超長命令語

		- VLIWプロセッサは、その実行ユニットが並列的に一度に実行できる、ロード・ストア・演算・分岐などの命令の複数個から成る、かなり長い命令語によってー単位の命令が構成されており、それをそのまま実行ユニットに投入する（各命令をatom、まとまったものをmoleculeなどと呼ぶこともある）

			- 主にRISCで利用

		- 「超長命令」の由来は命令語が最低でも（たとえば）128ビットといったように長いものであることからである。

- 高速化技術

	- 命令実行の一般例

		- 命令の取出し→命令の解読→データの取出し→命令の実行→結果の格納

	- 高速化技術

		- パイプライン制御

			- プロセッセ内部において複数の命令をオーバラップさせて実行させること、見かけ上の実行速度を向上させる方式である
			- 基本操作（ステージ、ピッチ）
			- 例：IF ID OA OF EX RS はそれぞれ異なるリソースを利用の基本操作、次の命令を前の命令を1ステージずつずらして実行できる

				- IF：命令取り出し
				- ID：命令解読
				- OA：オぺランドアドレス計算

					- operand addressed

				- OF：オぺランド取り出し
				- EX：実行
				- RS：実行結果格納

			- パイプラインハザード（hazard）

				- 制御ハザード

					- 分岐処理で処理の順番が変わる

						- 関数呼出しは分岐ので、関数呼出しは分岐命令です。

					- 投機実行

						- プロセッサは分岐しそうかどうかを予測し、即座に決定した方の実行を開始する、予測が間違っていたことがわかると、分岐命令以降の処理結果は全て捨てる

				- データハザード

					- 複数の処理で同じデータを扱うことにより不具合が生じる
					- 命令間の依存関係があると、待つかやり直しか

				- 構造ハザード

					- 同じハードウェアを同時に使用することより競合が原因となる

		- スーパスカラ方式

			- パイプラインを複数持ち、命令を同時並行的に行う仕組みである

		- スーパパイプライン方式

			- パイプライン方式における各ステージをさらに複数のステージに分けた仕組みである

				- Pentium4では１つの命令を20ステージに分けている

		- 先回り制御

			- ある命令の実行中に使用しない装置や回路があれば、次の命令の操作を始め、命令を重複（一部並行な感じ）させていく方式である

### マルチプロセッサ

- 命令の流れとデーたの流れを着目分類

	- SISD

		- Single Instruction Single Data stream（逐次処理）
		- ノイマン型のコンピュータ

	- SIMD

		- Single Instruction Multiple Data stream（並列処理）
		- 1命令で複数データを処理。アレイプロセッサ（array processor）など

	- MISD

		- Multiple Instruction Single Data stream
		- 単一のデータを複数命令で処理。パイプライン

	- MIMD

		- Multiple Instruction Multiple Data stream
		- 複数データを複数命令で処理。マルチプロセッサなど

- 密結合マルチプロセッサ

	- Tightly Coupled MultiProcessor: TCMP
	- 主記臆体やOS、ディスクなどの資源を共有

- 疎結合マルチプロセス

	- Loosely Coupled MultiProcessor: LCMP
	- 複数のコンピュータシステムをLANやWANで接続したシステム

- 対称型マルチプロセッシング

	- Symmetrical MultiーProcessing：SMP
	- 複数プロセスの役目はおなじ、どちらにもどちらかを代替できる

- 非対称型マルチプロセッシング

	- Asymmetric Multi-Processing：AMP
	- 役目違う：例OSのカーネルを実行するとアプリケションを実行する専用なプロセッサ

## 半導体

### 構成部品

- IC：Integrated Ciruit：集積回路

	- カスタムIC

		- ASIC：Application Specific Integrated Ciruit

			- 製造するとき回路設計を決定

		- FPGA：Field−Programmable Gate Array

			- 製造後に回路を変更できる

- LSI：Large Scale Integration：大規模集積回路

	- システムLSI／SoC（System On a Chip）

		- 組込みシステム製品の電子回路を1チップに集約した半導体製品

	- MEMS：Micro Electro Mechanical Systems

		- センサー、アクチュエータなどや電子回路を一つのシリコン基板などに集積化したデバイス
		- ICレベルも可能

### 故障メカニズム

- ESD破壊

	- 静電気放電（ElectroStatic Discharge）により、デバイスが劣化・故障すること。人体や装置、デバイスが帯電し、酸化膜や配線などが破壊される

- ラッチアップ

	- 構造上、期待していない位置にトランジスタやサイリスタなどができてしまうこと

- ストレスマイグレーション

	- 機械的な力で配線が切断されるなど

- エレクトロマイグレーション

	- 電流が過度に流れることによって配線が切断されるなど

### タイマー

- インターバルタイマー

	- 一定間隔でCPUに対して割り込みを発生させるタイマー、時刻更新などで使用

- ウォッチドッグタイマー

	- コンピュータの正常動作をかくにnするためのタイマーである、OSがウォッチドッグタイマーに対して一定間隔でクリアを行い、規定時間内クリアされなければシステム障害が起こったと判断し、システムをリセットする

- RTC：Real−Time Clock

	- コンピュータ内部に保持している時計である、日付や時刻などを示す可憐だ情報を持っており、システムの時刻の管理に使われる

## 入出力装置と入出力デバイス

### RAID

- Redundant Arrays of Inexpensive Disks
- ラベルの高さは処理方式やデータの方式パリティの配置などの違いを示すもので、高速性や信頼性の高さを示すものではない
- 種別

	- RAID0

		- ストライピング（striping）

			- データを分散することで高速化

		- ディスクの数より相応の倍数のスピードになる、勿論、総線等の制御がある

	- RAID1

		- ミラーリング
		- ライトは二回、リードは速くなれる

	- RAID2

		- 最小構成：データディスク２つ、ECC等検証用ディスク３つ、パリティディスクを固定、2台エラーにしても復旧可能

			- HDDの使い効率が悪い
			- パリティ計算にも複雑、スピードも悪い
			- 安全性が高い

	- RAID3、4

		- RAID3、4は検出可能、RAID3のデータはビット／バイト単位の一方、RAID4はブロック単位に分割する

	- RAID5

		- パリティ付きストライピング
		- １つディスク分の容量がパリティにする。パリティは均等に各ディスクに配置、分割はブロック単位

	- RAID6

		- RAID5➕一つ独立した冗長データを付けディスク

### バス

- シリアル

	- RS-232C

		- モデム接続の規格であったが、PCと周辺機器とを接続するようになったシリアルインタフェースである

	- USB：Universal Serial Bus

		- USBハブを介して最大127まで、接続デバイスにより別々のモードで対応する
		- USB1

			- ハイスピードモード：12Mbps
			- ロースピードモード：1.5Mbps

				- マウス、キーボードなどで利用

			- 5V／500mA

		- USB2

			- ハイスピードモード：480Mbps
			- 5V／500mA

		- USB3、3.1

			- スーパースピードモード5GMbps、スーパスピードプラスモード：10GMbps
			- 5V／900mA、20V／5A

		- USB4（thunderbolt3）

			- 40GMbps、typeーcモード：10GMbps
			- FireWireの後継技術規格（Start By Intel、Used By Apple）

		- プラグアンドプレイ機能や、ホットプラグ機能が揃えている

	- IEEE 1394（FireWire）

		- USB1と同時代スタートのもの、Appleが提唱したFireWireを標準化したもの
		- ツリー接続で最大64台、デイジーチェーン接続で最大17台
		- BackPlaneモード

			- 12.5 Mbps 、25 Mbps、50 Mbps

		- Cableモード

			- 100 Mbps、200 Mbps、400 Mbps

	- Bluetooth

		- 免許なし使える2.45GHzの周波数帯域
		- IEEE802.15.1で表中かされている

	- IrDA

		- Infrared Data Associationは、赤外線通信の標準化団体

	- SATA

		- Serial ATA、ATAで採用されていたパラレル転送方式をシリアル転送方式に変更したものである
		- eSATA（external SATA）：外付けドライブ用

- パラレル（Parallel）

	- ATA

		- Advanced Technology Attachment

	- SCSI

		- Small Computer System Interface
		- 一般はハードディスク装置、光ディスク装置、レーザプリンタ、CDーROM、イメージスキャナなどの高速データ転送
		- Ultra320 SCSIで、320Mbpsの転送能力を持つ
		- SCSIー3では、シリアル転送の規格もある

- 不明OR混在可能

	- ZigBee

		- 家電向けの短距離無線通信規格、Bluetoothと似ている
		- 省電力で低コスト

	- NFC

		- Near Field Communication

### 高速入出力制御方式

- DMZ制御方式

	- Direct Memory Access
	- DMAコントローラを用いて、CPUを通さずにメモリと入出力装置間やメモリとメモリ間データ転送

- チャネル制御方式

	- CPUの指示だけで、専用ハードウェアのチャネル装置で、データ転送、専用チャネル装置を用いてのDMZである

### ディスプレイ

- CRT：Cathode Ray Tube

	- ブラウン管を利用したディスプレイ

- STN：Super−Twisted Nematic 液晶

	- 単純マトリクス方式を採用したディスプレイ、XY軸電圧の交点で駆動
	- DSTN：Dual−scan STN

		- 上下分割することで表示速度を改善

- TFT：Thin Film Transistor 液晶

	- 薄型トランジスタを用い、アクティブマトリクス方式を採用、各液晶にアクティブ素子を配置させた方式

		- 高輝度

- 有機EL：Electro−Luminescence

	- バックライト不要、ELとは電圧をかけると発光する物理現象より、有機発光素子を利用したもの

		- 低電力

- プラズマ：plasma

	- ガラス板の間に高圧のガスを注入し、それに高い電圧をかけて発光させる、応答速度が速く、大型化も容易ですが、消費電力が大きいという欠点もある

		- 大型化

### 補助記憶装置（種類と例）

- 光ディスク

	- 再生専用型

		- 読込みのみ。CDーROM、DVDーROM

			- CD：Compact Disc

	- 追記型

		- 追加のみ（上書き不可）、CDーR、DVDーR、DVD＋R、BDーR

	- 書換え可能型

		- 一括消去して上書き。CDーRW、DVDーRAM、DVD＋RW、BDーRE

- 磁気ディスク

	- フロッピーディスク
	- ハードディスク

- 光磁気ディスク

	- MO

- 半導体ディスク

	- フラッシュメモリ（EEPROMの一種）

		- USBメモリ
		- メモリカード
		- SSD：Solid State Drive

- 磁気テープ：MT

	- DAT：Digital Audio Tape

		- ディジタル音声データを録音するための規格ですが、データのバックアップにも用いられる

			- DDS：Digital Data Storage

		- DAT72：36Gバイト、DAT320：160Gばいと

## メモリアーキテクチャ

### 情報素子

- ROM（Read Only Memory）

	- マスクROM

		- Masked ROM
		- 製造時点で記臆（以降の書換えは不可）

	- PROM

		- Programmable ROM
		- 使用者が最初に書込み（以降の書換えは不可）

	- EPROM

		- Erasable PROM
		- 一括消去と書換えが可能（紫外線で消去）

	- EEPROM

		- Electrically EPROM
		- 一括消去後、書換えが可能（電気的に消去）

- RAM（Random Access Memory）

	- 揮発性

		- 電源の供給がなくなると内容が消えてしまう

	- 動作原理

		- バイポール（Bipolar）

			- 高速
			- 雑音の影響大
			- 集積度低
			- ビット単価高
			- 主にキャッシュ

		- MOS型（Metal Oxide Semiconductor）

			- CMOS（Complementary MOS）、動作速度が速くした
			- BiCOMS（Bipolar Complementary MOS）、ひとつの基板にバイポーラとCMOSの両方を使って回路を形成したものである

	- 構造から

		- SRAM（Static RAM）

			- 電源が切らない限りに内容を保持
			- バイポーラ型

				- フリップフロップで構成され、複数のトランジスタ（transistor）をこみ合わせて1ビットを表現のため、集積度が低い
				- 主にキャッシュメモリでの利用

			- MOS型

				- 高速で消費電力が少ない、、バッテリで動作するような機器に用いられている

		- DRAM（Dynamic RAM）

			- 一定時間たつとデータが消失してしまう

				- 定時刷新が必要

			- MOS型

				- 主に主記臆に用いられる
				- １つの素子で1ビットを表現で集積度が高い
				- コンデンサ（condenser）に電荷を蓄えるため、時間が経過すると放電してしまう。そこで、状態維持するために、一定の時間（数ミリ秒）ごとに充電するためのリフレッシュ動作が必要

- 磁性体メモリ

	- 大容量、補助記臆装置として使われる
	- 磁気ディスク、ハードディスク、磁気テープ、DAT（Digital Audio Tape recorder）

- 光メモリ

	- レーザ光を利用して記録や再生
	- CDーDVD、DVD、ブルーレイデスク

### メモリシステムの構成

- キャッシュメモリ

	- データ格納方式

		- ダイレクトマップ方式

			- メモリのアドレスごとに、キャッシュメモリの格納場所が１つに決まる方式
			- 検索が容易ですが、衝突起こりやすいため、ヒット率が下がる

		- フルアソシアティブ方式

			- fully associative
			- アドレスによる振分を行わず、キャッシュメモリの空いているブロックなら使用する
			- データの使用時に毎回、全てのブロックを検索する必要があるため、応答速度に問題が出てくる

		- セットアソシアティブ方式

			- キャッシュをグループに分けて、グループ単位はダイレクトマップ方式、グループ内部はフルアソシアティブ方式

	- データ更新方式

		- ライトスルー方式

			- キャッシュと主記憶体を同時にライト

				- コピーレンシ（データの一貫性）は保たれる

		- ライトバック方式

			- キャッシュにライト、その後該当ブロックが主記憶体に追い出される（ページ置換えされた）時書き込み

				- コピーレンシは保たれない

	- 性能指標：ヒット率

		- 実効アクセス時間＝キャッシュメモリへのアクセス時間✖️ヒット率➕メモリへのアクセス時間✖️（1ーヒット率）

- 平均命令実行時間（平均メモリアクセス時間）

	- NFP（Not Found Probability）
	- TCache ✖︎ NFP ＋ TMemory ✖︎ （1 ー NFP）

- メモリインタリーブ

	- アクセスを高速化する手段
	- バンク単位に分割し、連続したアドレスを割り当て、複数のバンクを同時並行的に読み書きする

		- マルチトンネル

- 記憶領域の管理方式

	- メモリやキャッシュメモリなどの記憶領域を割り当てる時に、管理のアルゴリズムである
	- 代表アルゴリズム

		- ファーストフィット方式

			- 記憶領域の空き領域をアドレスの下位から順に検索し、最初に見つかった空き領域を割り当てる

		- ベストフィット方式

			- 空き領域の内、要求された大きさを満たす最小のものを割り当てる

### 主記憶装置の誤りの検出方式

- ECC（Error Correcting Code：誤り訂正符号）
- パリティチェック方式（Parity Check）

	- 奇数パリティチェック

		- 奇数ビット誤り検出可能、訂正不可

	- 偶数パリティチェック
	- 水平＆垂直パリティチェック

		- 1ビット誤り訂正、1以上はエラー位置より

- ハミング符号

	- 誤り箇所を最小の符号より簡単に計算できるために設計された符号アルゴリズムである
	- 1ビットの誤り訂正可能、2ビット以上は検出可能
	- アルゴリズム

		- 2の幂の位数は符号位、それ以外は情報位
		- 二進数で位数を表現し、二進数の各位が同じの位をパリティチェックを実施

			- 実現には、最大の符号位から1まで計算

	- 符号長

		- n ＝ 2のm階乗 ー 1

			- 符号自身の誤りも検出可能、全ての誤りの可能性2のm階乗で表示、mはハミング符号数

	- 情報数

		- k ＝ n ー m

- CRC：Cyclic Redundancy Check

	- 送信する基となるデータを、あらかじめ決まられた多項式で除算し、その余りをCRCである
	- 連続する誤りを検出するための制御の仕組みである、複数ビット誤り検出が出来る。

## 制御システム

### センサ：sensor

- 各種のデータ取集：ジャイロセンサ、音声、温度、気圧など

### アクチュエータ：actuator

- 機械・機構を物理的に動かすための機構です

## DVD／BD

### Digital Versatile Disk

### DVD：5〜10Gバイト

### BD：25〜100Gバイト

*XMind: ZEN - Trial Version*