# ＮＷ：０１_ネットワークインタフェース層
## データリンク
### IEEE802
#### IEEE802．3：イーサネット規格
#### IEEE802．1：認証など、LANの上位層でのプロトコル
#### IEEE802．11：無線LAN
### 名詞
#### 媒体共有型
##### 複数のノードで一つの通信媒体を共有する
#### 媒体非共有型
##### 通信媒体を共有せずに専用する
#### 半二重通信
##### CSMA／CA、CSMA／CD
###### CS：Carrier Sense
###### MA：Multiple Access
###### CD：Collision Dectection
* 衝突時、乱数で発生させた時間待って再送．二回、三回と衝突が発生した時には再送待ち時間が徐々に長くなるように乱数を制御している
    * 再送時間を衝突ウィンドウ時間（スロットタイム）と呼ぶ
###### CA：Collision Avoidance
###### ジャム信号
* 512ビット未満のMACフレームであり、MACフレームの最小のフレーム長は64バイトなので、512ビット未満のフレームを、各ノードが受信によって、転送路上衝突が発生したことを認識できる
#### 全二重通信
### イーサネットヘッダ
#### イーサネットフレームフォーマット
##### プリアンブル＋SFD：8オクテット
##### 宛先MACアドレス：6オクテット（オクテット＝バイト）
##### 送信元MACアドレス：6オクテット
##### タイプ：2オクテット
###### 長さと共用のため、Typeの値は1500以上
###### 例
* 0x0800：IPv4
* 0x0806：ARP
* 0x809b：AppleTalk
* 0x8100：IEEE802．1q
* 0x8137：IPX
* 0x86dd：IPv6
##### データ：46〜1500オクテット
##### FCS：4オクテット
##### 物理ヘッダ
##### Ethernetヘッダ
##### トレーラ
###### 受信したフレームに誤りがないかどうかを調べるために付加されるデータ。CRCという値が含まれる。
#### IEEE802．3規格
##### プリアンブル＋SFD：7＋1オクテット
##### 宛先MACアドレス
##### 送信元MACアドレス
##### フレーム長：2オクテット
##### LLC（Logical Link Control）：3オクテット
##### SNAP（SubNetwork Access  Procotol）：5オクテット
##### データ：38〜1492オクテット
##### FCS：4オクテット
##### 論理リンク制御
##### 物理ヘッダ
###### preamble:通信相手のNIC（Network Interface  Card）と同期を取るために使われる
* 「1」と「0」の繰り返しであり、その最後が「10101011」になっていると、その次のビットから宛先アドレス部が始まると解釈される
* SFD：Start Frame Delimiter
##### Ethernetヘッダ
#### MTU：Maximum Transmission Unit
##### データリンク層でのデータの最大値
###### 一回通信で転送可能のデータグラムのサイズ、データグラムとは、ネットワーク層以上のデータが格納されたパケットの部分．例：MACヘッダまでとFCSがデータリンク層までのヘッダに該当する、その内側のIPヘッダ＋TCPヘッダ＋データがデータグラムに該当する
#### MACアドレス
##### 一般的なNICでは、あらかじめハードウェアに割り当てられている．
###### 前半の24ビット目までが機器のメーカを示すベンダ識別子、後半はベンダ内でNICごとに一位に割り当てる
* ベンダ識別子：OUI（Organizationally Unique  Identifier）
    * 24bitのはMA−L（MAC~Address−Large）と呼ぶ
    * 28bitのはMA−M（MAC−Address−Medium）と呼ぶ
    * 36bitのはMA−S（MAC−Address−Small）と呼ぶ
###### すべてのビットが1のアドレスはブロードキャストアドレスと呼び、同じデータリンク内のすべてのNICに向けて送信される
#### コリジョンドメイン
##### イーサネットなどのネットワークでは、通信媒体を共有していて、CSMA／CD方式などによる衝突（コリジョン：Collision）あ発生する範囲がある
###### スイッチなどで分けられた範囲
#### ブロードキャストドメイン
##### ブロードキャストアドレスはグループアドレスで、同じデータリンク内にある機器にはすべて送られる、違うデータリンクに中継されることはない
###### ARP、DHCPなど
#### PoE：Power over Ethernet
##### イーサネットの配線で利用されるUTPケーブル（カテゴリ5以上）を使って電源を供給する技術
###### IEEE802．3af
* 4対のより対線の2対を使って電源を供給する
    * 無線アクセスポイント
    * IP電話機
    * スイッチングハブ
    * など
###### IEEE802．3at／PoE＋
* 大電力に対応した規格、各ポートに30Wの電力を供給できる
#### PLC：Power Line Communications
##### PoEとは逆に、電力線通信
#### 転送モデルシステムでは、2局間の最長経路には、五つのセグメント及び四つnおリピーター、二つのMAU（Media Auth  Unit）及び二つのAUI（Attachment Unit Interface）を含めることができる
### 無線LAN
#### 電波や赤外線、レーザー光線などを利用する無線LANがある
##### 起源
###### ALOHAネット
* 1970年にハワイ大学が開発した先駆的なネットワークシステム
    * ハワイ島々に点在しているキャンパスを結ぶために、アマチュア無線にように電波を共有して通信を行う仕組み
    * 無線の場合は、二つの送信局が同時に通信しようとすると混信が発生してデータが破壊され、そのためALOHAネットでは、混信した時には手動で再送している
* イーサネットより古く、イーサネットはALOHAネットを参照に考案されている．無線LANの方が有線LANより先に実現されている
#### CSMA／CA
##### バックオフ制御時間
###### 搬送波感知（CS）の段階で通信を検知した際に、その通信の終了後すぐに送信を試みると衝突が発生しやすくなる．それを避けるため、通信終了後にランダムな長さの待ち時間をとり、しばらく待ったあとでデータの送信を開始する
#### IEEE802．11
##### a：54Mbps：5GHz
###### 変調方式にOFDMを用い
##### b：11Mbps：2.4GHz
###### 変調方式にBPSK、QPSK、CCK
##### g：54Mbps：2.4GHz
###### CCK、OFDM
##### n：150〜600Mbps：2.4GHz／5GHz
###### チャネルボンデイングを使用して隣合う帯域のチャネルを二つ束ねることと、MIMO（Multiple Input Multiple Output）を使用して複数のアンテナで送信を行うことで高速化を実現している
* 20MHzのチャネル幅を二つ繋げて使うチャネルボンディングという技術で、40MHzのチャネル幅を利用することができる
###### フレームアグリゲーション（Frame Aggregation）で、フレークを連結して待ち時間を短縮する手法を取るも可能
###### 変調方式にはOFDM
##### ac：1.3Gbps（第1世代）：5GHz
###### MU-MIMO（Multi-User）
* 変調方式はOFDM
##### ax：9.6Gbps：2.4GHz／5GHz
###### MU-MIMOが4ストリームから8ストリームに拡張され、週波数を効率的に割り当てるために、携帯電話でも使用しているOFDM（Orthogonal  Frequency Division Multiplexing）が採用されている
* WiFi6
##### i
###### 通信規格ではなく、無線LANのセキュリティ規格である
#### 動作モード
##### アドホックモード（adhoc）
###### 端末同士が直接通信する形態
##### インフラストラクチャモード
###### それぞれの端末が、ネットワークを統括するアクセスポイントを経由して通信をする
#### アクセスポイント
##### アクセスポイントを識別子するためのIDとしてSSID（Service  Set Identifier）が設定されている
###### ESS-ID（Extended  SSID）
* 複数のアクセスポイントで同じIDを設定することができ、これを区別するためのもの
    * 複数のアクセスポイントで同一のSSIDを利用すると、場所を移動しても無線LANを使い続けることができるローミング機能を実現できる
###### 一つのアクセスポイントに複数のSSIDを持たせ、VLAN機能と合わせてVLAN−IDとSSIDを対応させることで、ネットワークを複数に分割することも可能
##### 2020近年では、複数のアクセスポイントを1箇所で制御するために無線lANコントローラを用いることも多い
##### アクセスポイントには、アクセスを管理するためにPCF（Point  Coordination Function）ということ仕組みがあるため、インフラストラクチャモードの方が効率的に通信を行うことができる
#### 隠れ端末問題
##### CSを行う時には、有線と異なり、「アクセスポイントまでの距離は規定の範囲内だが電波が届けない」という状態が起こりえる
###### 例：アクセスポイントを挟んで反対側の端末には、端末のお互いに電波が届きません、この状態は二つ端末を向こう側として隠れ端末問題になる
* RTS（Request To Send）
CTS（Clear To Send）
    * データ通信を行う前に端末がまずRTSという制御フレームを送信する、それを受信したアクセスポイントが、全端末に向けてCTSを送信する．RTSとCTSには送信抑止時間が含まれており、これらの制御フレームを受信した他の端末には、指定された時間、送信を抑止する
#### 近距離無線通信
##### Bluetooth
###### IEEE802.15.1として規格化、2.4GHz帯域を利用している
* 一つのマスタと最大七つのスレーブで、最大8台のスター型のネットワークを構成している
##### BLE：Bluetooth Low Energy
##### ZigBee
###### IEEE802.15.4
* 複数のセンサを協調させるセンサネットワークを目的とする通信規格です．消費電力が少なく安価で、最大65536個の端末間をつなぐことができる
##### Wi−SUN：Wireless Smart Utility  Network
###### IEEE 802.15.4gをベースに相互接続を行う無線通信規格です．途中の中継器を経由するマルチホップによる接続を使用し500m〜1kmの遠距離での通信が可能
* センサネットワーク
    * 複数のセンサ付きの無線端末がお互いに協調して環境や物理的状況のデータを採取する無線ネットワークです
### PPP：Point-to-Point Protocol
#### データリンク層だけのコネクション型のプロトコル、PC上では「ダイアルアップネットワーク」とも呼ばれる
##### NCP：Network Control Procotol
###### 上位層に関するやりとりを行い
* 上位層がIPの時には、IPCPを利用、IPアドレスの自動割り当てなどを行う
##### LCP：Link Control Procotol
###### コネクション確立や切断、ユーザ認証を行う
* 認証プロトコル
    * PAP：Password Authentication  Procotol
        * ユーザIDとパスワードで認証を行う方式
    * CHAP：Challenge Handshake Authentication  Procotol
        * チャレンジレスポンス方式
            * 1．サーバが毎回異なるデータを生成し、それをチャレンジとしてクライアントに送り
            * 2．クライアントでは、送られたチャレンジと、利用者が入力したパスワードを演算し、その結果をレスポンスとしサーバへ送る
            * 3．サーバはレスポンスを受け取り、サーバに登録されたパスワードを用いて演算を行い、一致性より認証する
#### フレームフォーマット
##### HDLCと呼ばれる形式と同じ
###### フラグ：1Byte：01111110
* 「01111110」はフレームの区切り、途中にあるとエンコードが必要
###### アドレス：1Byte
###### 制御：1Byte
###### データ：0〜1500Byte
###### FCS：4Byte
###### フラグ：1Byte：01111110
#### PPPoE：PPP over Enthernet
##### イーサネットには認証機能やコネクション確立／切断機能、課金管理の機能がないため、PPPを合わせて利用することで、コネクション管理を実現する
##### フレームフォーマット
###### イーサネット：14Byte
###### PPPoEヘッダ：6Byte
###### PPPプロトコル：2Byte
###### データ：38〜1492Byte
###### FCS：4Byte
### その他データリンク
#### FFDI：Fiber Distributed Data  Interface
##### トークンパッシング方式（アペンドトークン方式）で通信を行うデータリンクです．光フィーバーやツイストペアケーブルを用いて、100Mbpsの伝送速度を実現できる
###### トークンパッシング
* トークン（送信權）をネットワーク上回す、衝突が発生せず、混雑しても性能が大幅低下はしない．
###### アペンドトークン方式
* データを一つずつトークンで送っているネットワークの性能を十分に行かせないため、他の端末がトークンに付けたフレームを中継しながら、そのフレームの後ろに自分が送信したいフレームを付加する方式
#### ATM：Asynchronous Transfer  Mode
##### コネクション型、ヘッダ5バイト＋データ48バイトの53バイトのセルという単位に分割して、通信を行う
###### 日本からスタート、次世代にならず
#### IEEE1394
##### FireWire、i.Linkとも呼ばれる規格で、AV機器を結ぶ LANでのデータリンクです
#### HDMI：High-Definition Multimedia Interface
##### バージョン1．4から、イーサネットのフレームを伝送する規格も追加されて、TCP／IP通信を行うことが可能になった
### 物理層
#### ケーブルの種類
##### AP：ネットワークの章を参照
###### 光ファイバケーブル
* コアと呼ばれる芯を、グランドを呼ばれる、コアとは屈折率が異なることを利用してコアの中に光が閉じ込めて転送
    * シングルモード
    * マルチモード
## LAN間接続
### LAN間接続装置のうちデータリンク層以下に動作する装置には、リピータハブやスイッチングハブがある
#### スイッチングハブ
##### イーサネットスイッチまたは単にスイッチと呼ばれる装置、MACアドレスを元にフレームの中継を制御する
##### MACアドレステーブル
###### メモリ上あるもの、電源を入れた当初は何もない．MACアドレスを学習し、MACアドレステーブルにエントリする．その後、必要なポート飲みにフレームを転送することで、不要な通信をフィルタイングすることができる
##### 転送方式
###### ストア＆フォワード方式
* 一旦フレームをすべて受け取り、FCSをチェックしてエラーがないか確認した後に転送方式
###### カットスルー方式
* 宛先MACアドレスを受け取った段階で転送先を決め、FCSチェックがない
##### ポートミラーリング
###### 障害時やネットワーク管理時には、特定のポートに流れているデータを監視必要な場合利用する．未使用のポートを、監視するポートのミラーポートして設定できる
##### オートネゴシエーシン
###### スイッチングハブ同士を接続する場合や、スイッチングハブとサーバを接続する場合などには、お互い通信速度や通信方式を合わせておく必要
←この選択を自動で行う機能
* 合わせるもの
    * 通信速度
    * 全二重通信、半二重通信
        * 半二重通信では、ジャム信号を利用している
            * ジャム信号を使って、送信データの転送を制御抑制することを、バックプレッシャ（back pressure）という
        * 全二重通信では、待ち時間を指定のpauseフレームよりフロー制御を行う
* お互いの機器画FLP（Fast Link Pulse）バーストと呼ばれる連続したパルスを送出することによって相手の伝送速度と通信方式を判断する
###### 固定モードのハブと接続する際に、調整がうまくいかず、不具合が発生することがある．これは、オートネゴシエーションでは、相手とのやりとりができないと半二重で通信するよう設定されるからです
##### AutoMatic（Auto MDI／MDI−X）
###### UTPケーブルを利用するイーサネットのポートには、MDIポートとその信号を受信するMDI−Xポートの2種類がある．
* MDI：Mdeium Dependent Interface
* MDI−X：MDI Crossover
###### MDIとMDI−Xの接続には一般的なケーブル（ストレートケーブル）、MDI同士やMDI−X同士の接続にはクロスケーブルを用いないと通信できない
* ストレートケーブル：直连线：Straight-Through Wired Cables
    * 一般にパソコンとパソコン以外の機器（ハブやルータなど）を接続する場合に使用するケーブルです。
ストレートケーブルはコネクタ同士の同じピン同士を接続しているため、コネクタ部分を見ると同じ色の線が同じ順番で並んでいます。
* クロスケーブル：交叉线：Crossover Wired Cables
    * パソコンとパソコンを機器を使用せず直接接続する場合に使用するケーブルです。
単純に 2 台のパソコンをケーブルで接続しデータ通信する場合にはクロスケーブルを使用します。
クロスケーブルはコネクタ同士の交差しているピンを接続しているため、コネクタ部分を見ると同じ色の線の順番が異なって並んでいます。
###### 近年のスイッチングハブなどでは、相手のポートタイプを判別して自分のポートタイプを自動的に変えて接続するAutoMatic  MDI／MDI−X機能がそろえたものが増えており
##### リンクアグリゲーション：LAG：Link Aggregation
###### スイッチイングハブとホスト間、またはスイッチングハブ間などを複数の回線で接続し、それらを論理的にひとつに束ねる技術です、信頼性と性能の両方を向上できる
* 例：スイッチングハブ間を100MbpsのUTPケーブル2本で接続し、リングアグリゲーションを使用すると、ハブ間の通信速度は200Mbpsになり、一本障害が発生しても、ハブ間の継続通信は可能のまま
###### 設定方法
* 静的な設定
* 動的な設定
    * スイッチ間でネゴシエーションを行って動的に設定するLACP（Link Aggregation Control Protocol）がある
        * IEEE 802．3adで標準化されている
##### リピータと比べると壊れやすい
###### スイッチングハブは、アドレス学習機能やフィルタリング機能を持ち、スイッチの切替を行い、CPUとメモリが持っている、全体的に壊れだけでなく、ポートごとに故障することもある
* 冗長化を実現する仕組みが必要
#### スパニングツリー
##### ループを防止するための仕組み
###### ループがあると、スイッチの特性よりブロードキャストフレームなど全員向けのパケットを、すべてのポートにコピーして転送する．無限ループになって、フレームがネットワークを埋め尽くしてメルトダウンに至る
##### ループを持たない、木構造のネットワーク．スパニングツリープロトコル（Spanning  Tree Protocol：STP： IEEE802．1D）
###### ポートステータス
* Listening
    * フレームを転送しない
    * 送信元MACアドレスを学習する
    * BPDUを送受信し合う
* Disable
* Learning
* Blocking
* Forwarding
    * フレームを転送する
    * 送信元MACアドレスを学習する
    * BPDUを送受信し合う
* RSTP、MSTPではDiscardingに統合され
    * フレームを転送しない
    * 送信元MACアドレスを学習しない
    * BPDUを受信する
###### 各ブリッジは、1~10秒の間で設定した間隔で、BPDU（Bridge Procotol Data Unit）と呼ばれるパケットを送信する．BPDUに含まれている情報にはブリッジIDとパスコストがある
###### 1．ルートブリッジを決め
* ブリッジIDが最も小さいブリッジが選定され
    * ブリッジID（8バイト）＝ブリッジプライオリティ（２バイト）＋MACアドレス（6バイト）
###### 2．各サブブリッジのルートポート（RP：Root Port）を決め
* ルートブリッジに最も近いポートが選定され
    * 近いの標準はパスコスト
        * パスコストの初期値は、リンク速度ごとに推奨値が決められている
            * コストが16ビットの場合
                * 10Mbpsのコストは100
                * 100Mbpsのコストは19
                * 1Gbpsのコストは4
                * 10Gbpsのコストは2
###### 3．各ブリッジの代表ポート（指定ポート：DP：Designed Port）を決め
* 各セグメント（ブリッジAとBの間など）において、最もルートブリッジ近いポートを選定され
    * ルートポートまたはブロッキングポートと接続しているポート
###### 4．残るのはブロッキングポート
* ブロッキングポートからの送信は不可、受信は可能
* 木の葉のブリッジの接続しているポートの内、ルートブリッジからの総パスコストが低いのは代表ポートになり、高いのはブロッキングポートになる
##### 経路変化に時間がかかる
###### BPDUを定期的に受信することによって障害を検知している、BPDUを最後に受信してから、設定した時間（エージングタイム）経過すると障害が発生とみなし、再度スパニングツリーの計算を行う
* そのため、IEEE 802．1Dのスパニングツリープロトコルでは、障害時の通信経路の切り替えに数十秒程度の時間がかかるという問題がある
    * 待ち時間が長いことや、VLANを構成する環境ではうまく対応できないなどの問題がある
        * 対策として、発展形としての規格がいくつがある
            * RSTP：Rapid STP：IEEE801．1W
                * STPのブロッキングポートを代替ポートとバックアップポートの二つの役割二分けツリーの再構築を加速する
                    * AP (Alternate Port)。ルートポートのバックアップ用のポート。ルートポートのリンクダウン時に即座にルートポートの役割を引き継ぎフォワーディングになる。CiscoのUplinkFastと同等機能。
　代替ポートはルートポートと指定ポートに選出されなかったポートなのでSTPでいう非指定ポート。
                    * BP (Backup Port)。指定ポートのバックアップとなるポート。指定ポートがダウンした際、即座に指定ポートの役割を引き継ぎ、フォワーディングになる。このBPはリピータハブ等の共有メディアとスイッチとが接続する場合に発生するポートです。ポートがDPでBPになるかは送信元ポートID (ポートプライオリティ+ポート番号)で比較。小さい方がDPになる。
                    * 障害時の切替時間は1~3秒程度、STPよりかなり短縮される
                * ポートステータス
                    * Learning
                    * Forwarding
                    * Discarding
                        * BPDU設定電文のみ受信
            * MSTP：Multiple STP：IEEE801．1Q
                * 複数のVLANごとにスパニングツリーを構成するプロトコル、VLANごとにブロッキングポートを設定することが可能となり、通信に柔軟に対応できるようになる
* なぜかこの時間がかかるのは、切替中、旧のツリー中のブリッジは一時的なループにならないため、ポートステータスをBlockingからデータ転送できる状態へ切り替えの途中にLearning状態が追加、二回の状態切り替えの時間どちらもForward Delay（一回のデフォルトは１５秒）
##### その他規格
###### TRILL：TRansparent Interconnection of  Lots of  Links
* 最短経路が複数ある時には、負荷分散を行うことで、冗長化と高速化の両方を実現できるようになり
    * 仮想化技術であるFCoE（Fibre Channel  over Ethernet）と相性が良いため、仮想化環境でよく用いられる
* TRILLに対応したスイッチは、ルーティングブリッジ（RB）と呼ばれ、複数のRBで構成される1組ネットワークをRBファブリックという
    * SPFより計算している
    * OSIで開発されたISーIS（Intermediate System to Intermediate System）というルーティングプロトコルを用いている．L3のOSPFも、このISーISを元にして設計されている
#### VLAN
##### 配線を変えずにネットワーク構成を変更するための技術
###### 同じスイッチングハブハブに接続している機器を論理的に別のネットワークにすることで、ブロードキャストドメインを分割することができる
* 代表的な実現方法
    * ポートペースVLAN
        * スイッチのポートごとに、VLANの識別番号である VLAN  ID（VID）を設定し、所属するVLANを決める方式です．一スイッチ中に接続する各ポートをグルーピングし複数のブロードキャストドメイン（VLAN）に分割する
    * タグVLAN
        * ポートベースVLANを拡張し、異なるスイッチ間でもVLANを構築できるための技術
            * IEEE 802．1Qで標準化され
                * VLANタグを送受信するリンクのことを、トランクリンク又はタグ付きポートなどと呼ばれる
                * おもにCISICでは、ネットワーク全体自動的にVLAN−ID＝1のグループになる．このVLAN−ID＝1のグループは、デフォルトVLANと呼ばれる
            * イーサネットフレームにタグ情報を付加することで12ビットのVLAN  ID（VID）を設定する．スイッチ間フレームを転送する時には、イーサネットヘッダーにVLANタグを挿入し、その値を基に、どのVLANに転送するかを決定する
                * IEEE802．1Xを利用し、認証に成功したパソコンのポートに新しいVLAN−IDを通知して、動的にVLANを切り替える方式もある．→認証VLAN
* 利用例
    * 広域イーサネットで会社ごとにネットワークを分ける
    * ウィルス対策のため感染の恐れがあるPCを隔離
* 二つのVLAN間で直接の通信ができなくなるため、VLAN間の通信はルータ機能を揃えたスイッチであるレイヤ３スイッチ（L3）が必要です
## 通信サービス
### 種類
#### 専用回線
    接続形態が必ず1対1の専用のネットワークです．高いセキュリティや接続の安定性を確保したい場合に利用する．
    

##### 高速ディジタル専用線
##### ATM専用線
#### 交換回線
##### 回線交換
    回線の切り替えを行い、1対1での通信を実現する回線交換
    

###### 公衆電話網（アナログ電話回線）
###### ISDN：Integrated Services Digital  Network：ディジタルな電話サービス
###### 移動体通信サービス
##### 蓄積交換
    パケットを通信経路に流すことで複数人で回線を共有する蓄積交換
    

###### フレームリレー
* パケット交換サービス（X.25）を簡素にして高速化したネットワークです．昔は64kbps~1.5Mbps程度の通信速度のサービスが提供されていた
###### ATM：Asynchronous Transfer  Mode
* 53バイトのセルに分割したパケットで通信．複数の通信機器を束ねて一つの回線で接続するTDM（Time  Division Multiplexer：時分割多重化装置）という機器を利用して、通信回線の利用効率が向上させ
    * バックボーンネットワークで使われており、物理層にはTDM方式のSONET／SDHを利用することが多いです
###### IP−VPN
* 通信事業者が提供する専用のIPネットワークでVPN（Virtual  Private Network）を構築します．
    * パケットの前にラベルを付けて通信を識別するMPLS（Multi−Protocol Label Switchingという技術が使っている）
        * MPLS構造
            * レイヤ２ヘッダ
                * レイヤ2ヘッダ
                * MPLSヘッダ：4バイト
                    * ラベル：20ビット
                    * EXP：3ビット
                    * S：1ビット
                    * TTL：8ビット
                * IPヘッダ：20〜60バイト
                * TCPセグメント
                * レイヤ2トレーラー（FCS）
        * ルーティングアルゴリズム
            * LDP（Label Distribution  Protocol）など
        * MPLS
            * CER：Customer Edge Router
                * 利用者ごとの境界ルータ
            * PER：Provider Edge Router
                * プロバイダの境界ルータ、CERと接続し、CER対応の利用者を示すラベルと呼ばれるタブ情報をパケットに付加し、IP−VPNに流す
            * LER：Label Edge Router
                * ラベルを付加するルータ
            * LSR：Label Switching Router
                * PERや他のLSRと接続、ルーティングを行わずMPLSでのスイッチングを行う
            * LSP：Label Switch Path
                * MPLSでは、宛先などの扱いが同じパケットは、どれもラベルによって同じ経路を辿り、その道筋はLSPと言い
                    * LSPは片方向のパスので、両方向の通信に用いるのは二つのLSPが必要になる
* IPSecを使ってインターネット上に独自にVPNを構築するインターネットVPNもあり
    * 従来の専用線やフレームリレー網によって接続していたWAN回線を置き換えたとしても、従来ノアドレス体系のままで移行できるという利点がある
###### 広域イーサネット
* 通信事業者が提供するデータリンク層の専用のイーサネット接続サービス、VLANを用い、他の顧客との通信を分離する
    * IEEE  802．1QのタグVLANを利用している、そのため、複数のスイッチを経由しても物理的な状況に影響されず、同じ契約なら同じネットワークにすることが可能です．すべての処点が直接つながるフルメッシュでの接続となり
        * IEEE  802．1Qトンネリング
            * VLANを利用し、それぞれの顧客の通信を別々ニア使うできる
                * スタックVLAN（拡張タグVLAN、VXLAN）と呼ばれる通信事業者独自のVLANタグをつけ加える仕様のサービスは、IP−VPNとほぼ同じ方法によってユーザごとのVPNを構築できる．つまり、拡張VLANタグがMPLSヘッダの代わりをしていることになる（それ以外概念上IP−VPNとかなり類似）
                    * ARP要求パケットのようなブロードキャストや、BPDUなどのマルチキャストの転送が、広域イーサネット内で透過的に転送されるか、あるいは破棄されるのかといった通信事業者独自のフィルタリング要件を確認が必要
            * IEEE 802.1ad
                * 顧客のVLAN付きのパケットを、さらに別のVLANタグをつけることによってカプセル化する仕組み
    * ネットワーク層は何なんでも構いませんので、ホストと端末との通信など、独自のプロトコルでIPを用いないネットワークなどでも利用できる
* 高速化技術
    * WAN高速化装置：WAS：WAN Acceleration System
        * コネクションの管理のほかにデータ圧縮技術などを併用し、WLAN回線の高速化を図る
###### インターネット接続サービス
#### アクセス回線
    蓄積交換は、通信事業者が用意した回線が全国に張り巡られている．しかし、その回線は、特定の場所に設置されているアクセスポイントまで行かないと利用できません．その特定の場所に接続するための別の回線はアクセス回線といい
    

##### MDF：Main Distribution Frame：主配線盤
###### 光ファイバーケーブルを用いて収容局からマンションへ、その後各DSL（Digital Subscriber Line：ディジタル加入者回線）よりMDFへ接続する
##### 専用線
##### ADSL：Asymmetric Digital Subscriber  Line
###### 既存のアナログ回線のを拡張利用し、高速なデータ通信を行い、スプリッタで音声（低周波）とデータ（高周波）を混合、分離する
* 上がり方向の通信速度は下り方向に比べる遅いのが特徴
    * 上がりの偏重周波数帯域が下りの変調周波数帯域に比べて狭くなっているのため
##### FTTH：Fiber To The Home
###### 高速の光ファイバを建物内に直接引き込む、回線の終端にはONU（Optical  Network Unit）を用いて、光と電気信号を変換する
* WDMを用いることで、1本の光ケーブルで送信と受信の両方を実現する
    * ネットワーク構成より分類
        * ポイントツーポイント（PーP）
            * 収容局と住宅を1対1で接続
        * ポイントツーマルチポイント（PーMP）
            * ユーザの近くまでは1芯の光ファイバーケーブルを使用し、その先は各ユーザに個別に光ファイバーケーブルを配線
                * スター型に光ファイバーケーブルを分岐必要、PON（Passive Optical Network）、途中に設置される光カプラが電力を必要としない受動的な素子で動作する、その他EPON（Ethernet PON）もある
##### ケーブルテレビ
###### 通常はテレビ放送を提供するサービス、そのケーブルを使い、テレビ放送2割当てていない空きチャネルを利用してインターネット接続サービスを提供する
* 下方向にはテレビ放送となじ周波数帯域を使い、上り方向には普段使われていない低周波数を利用するため、上りに比べて上りの通信速度は遅くなる
* 規格：DOCSIS：Data Over Cable Service Interface Specifications
#### 無線通信技術
##### 無線lANだけでなくWANなど様々なものがある、無線通信は多重化させることで、多くの接続を一たびに処理することが可能になる
###### 主な種類
* 携帯電話
    * 端末電波⇄最も寄り基地局⇄通信事業者の局舎（音声ネットワークとデータネットワークに分けて通信を行う）
* WiMax：Worldwide Interoperability for Microwave Access
    * 広帯域の無線アクセス技術の規格の一つ、FTTHやADSLと同じく、インターネットへのアクセス回線として利用され、IEEE 802.16eで標準化されている
* 公衆無線LAN
    * WiFi（IEEE  802．11など）の無線lAN技術、ホットスポットと呼ばれるエリアをさまざまな場所に設置してインターネット接続を実現する
* 仮想移動体通信事業者：MVNO：Mobile Virtual Network Operator
    * 無線通信回線設備の設置・運用せずに、自社ブランドで通信サービスを提供する事業者の事です．
* LPWA：LowPower WideArea
    * バッテリ消費量が少なく、一つの基地局で広範囲をカバーできる無線通信技術、LPWANと呼ばれるもある
        * IoTで活用され、複数のセンサーが同時に繋がるネットワークに適している
            * 規格
                * LoRaWAN
                    * 標準化団体 LoRa Allianceが策定しているオープン規格、免許不要な920MHz帯域を利用し、10km程度の長距離でのデータ通信が可能
                * Sigfox
                    * フランスのSigfox社の独自規格、免許不要の920MHzを利用する、Sigfox社と提携したサービス事業者と契約する必要がある
                * NB−IoT
                    * 携帯電話の通信技術（LTE：Long Team Evolution）を利用する、通信事業者の免許が必要となるLPWAです、低速（上り：62kbps、下り：21kbps）
* DSRC：Dedicated Short Range  Communications
    * 5.8GHz対を使用する近距離の無線通信方式であり、有料道路の料金所のETCなどで利用されている
###### 多重化方式
* FDM：Frequency Division Multiplexing
    * 複数のディジタル信号を異なる周波数体d絵送ることで多重化する方式．各周波数（サブキャリア／搬送波）の位相を直交させ、お互に干渋しないようにOFDM（Orthogonal  Frequency Division Multiplexing）などで幅広く利用されている
* TDM：Time Division Multiplexing
    * 時分割多重
* CDM：Code Division Multiplexing
    * 符号分割多重、複数の送信者が同一の周波数帯を共有し、それぞれに信号の異なる符号を掛け合わせることで多重化を実現する方式
* WDM：Wavelength Division Multiplexing
    * 波長分割多重、光ファイバに波長の異なる複数の光信号を送る
* CCK：Complementary Code Keying
    * 4相の位相変調と符号を組み合わせることで多重かを行う方式、IEEE  802.11bなどで利用されている
### 通信のバースト性
#### ある通信回線やネットワークなどに、一時的に大量のデータが流れること。また、他のコンピュータに機能やデータを提供するサーバコンピュータに、一時的に大量のデータ送信要求や処理要求が届くこと。
